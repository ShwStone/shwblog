---
title: 概率小题
date: 2023-12-04 13:27:26
tags:
  - 数学
  - 概率论
categories:
  - 数学
  - 概率论
comments: true
sticky: 2
---

---

<!--more-->

## 自己 YY 的题目

将一伯努利事件重复 $2n$ 次，恰好得到 $n$ 次正例和 $n$ 次反例，求正例概率 $q$ 满足 $q \in [0.4, 0.6]$ 的概率是多少？

在试验开始之前，我们可以对 $q$ 所遵从的概率分布做一个先验假设。假设 $Pr(q \in [0, x])=\int_0^xp(q) \mathrm dq$，即 $q$ 遵循概率密度函数为 $p$ 的分布。一个合理的猜想是平均分布 $p(q)=1$。

为了方便，我们用 $A$ 表示事件“恰好得到 $n$ 次正例和 $n$ 次反例”。

显然，$A$ 是一个典型的二项分布。如果我们已知 $q$，则可以知道 $P(A|q)=C_{2n}^nq^n(1-q)^n$。

则我们要求出的是 $p(q \mid A)$。使用针对连续型随机变量的贝叶斯公式以及全概率公式，我们得到：

$$
\begin{aligned}
p(q \mid A) &= \frac{P(A \mid q)p(q)}{P(A)} \\
&= \frac{P(A\mid q)p(q)}{\int_0^1P(A \mid u)p(u)\mathrm du} \\
&= \frac{P(A \mid q)p(q)}{P(A)} \\
&= \frac{C_{2n}^nq^n(1-q)^np(q)}{\int_0^1C_{2n}^nu^n(1-u)^np(u)\mathrm du} \\
&= \frac{q^n(1-q)^np(q)}{\int_0^1u^n(1-u)^np(u)\mathrm du}
\end{aligned} 
$$

运用 Beta 函数定积分，得到： $p(q \mid A)= q^n(1-q)^np(q)\frac{(2n+1)!}{(n!)^2}$。

如果假设先验分布是平均分布，则我们要求的结果为：

$$
\frac{(2n+1)!}{(n!)^2}\int_{0.4}^{0.6}q^n(1-q)^n\mathrm dq
$$

这个东西没有闭合形式，但是我们可以快速验证完备性：当积分上下界是 0 和 1 时，结果是 1；当我们取 $n=5$ 时，得到结果大约 $0.506$，说明少量样本并不具有说服力；而当 $n=100$ 时，结果接近为 1。

![](/images/msp206811718cahb33di9bcb00000d272ab88b0ibc42.gif)

一个有趣的事实是，无论一开始的先验假设如何，只要没有一处函数值为 0，则最终我们的结果都会变成 1。这体现了实验是如何一步步改变我们的观点的。

