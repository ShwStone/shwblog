---
title: 杜教筛
comments: true
top: 2
date: 2022-10-21 08:37:22
updateDate: 2022-10-21 08:37:22
tags:
categories:
---

<!--more-->

## 狄利克雷卷积

定义两个函数的狄利克雷卷积如下：

$$
\begin{aligned}
f(x) * g(x) &= (f * g)(x)\\
&= \sum_{ab=x}{f(a)g(b)}\\
&= \sum_{d \mid x}{f(d)g(\frac{x}{d})}
\end{aligned}
$$

其中第一个表达式作为定义式，可以在进行和号变换的时候对理解产生很大帮助。第二个式子则更为常见，可以应用在各种反演之中：

比如常见的莫比乌斯反演和欧拉反演（证明见[反演](/2022/10/24/反演)）（$I(x)=1$）：

$$
\begin{aligned}
(\mu * I)(x) &= \sum_{d \mid x}{\mu(x)I(x)}\\
&= \sum_{d \mid x}{\mu(x)}\\
&= [x=1]\\
\\(\varphi * I)(x) &= \sum_{d \mid x}{\varphi(x)I(x)}\\
&=\sum_{d \mid x}{\varphi(x)}\\
&=x
\end{aligned}
$$

好，这些知识就足够了。

## 杜教筛

杜教筛其实就是能筛这样的一个函数：

$$
f(x)=G(x)-\sum_{d=2}^{x}f(\lfloor\frac{x}{d}\rfloor)
$$

如果 $G(x)$ 可以很快地算出来的话，那么第二项可以利用[数论分块](/2022/10/24/数论分块)递归 $\sqrt x$ 次。然后对于这个东西记忆化。时间复杂度我不会证，这里贴一个[搜出来的](https://www.mina.moe/archives/5676) 。

> 复杂度证明：  
我们使用同一法来简单证明。总时间复杂度可以看成是所有在递归过程中出现过的 $n$ 对应的时间复杂度的和。  
显然并不是每一个 $[1, n]$ 之间的数都出现了，具体哪些出现了呢？大致是所有 $\lfloor\frac{n}{i}\rfloor$
在每个 $\lfloor\frac{n}{i}\rfloor$ 上花费的时间又是 $O(\sqrt{\lfloor\frac{n}{i}\rfloor})$ 的，因此：  $$T(n)=\sum_{i=1}^{\sqrt n}{\sqrt{\frac{n}{i}} + \sqrt i}$$  
显然这个式子中 $\sqrt i$ 的项每一项都不大于 $\sqrt{\frac{n}{i}}$ 的项，因此可以忽略。 
那么  $$T(n)=\sum_{i=1}^{n}{\sqrt{\frac{n}{i}}} \le \int_1^{\sqrt n}{\frac{\sqrt n}{\sqrt x}} = 2 \sqrt n \sqrt[4] x = O(n^{\frac{3}{4}})$$

然后我们如果用线性筛求出前 $O(n^{\frac{2}{3}})$ 个前缀和，就可以进一步将复杂度压到 $n^{\frac{2}{3}}$ 。

那么问题来了，什么样的函数可以满足 $f(x)=G(x)-\sum_{d=2}^{x}f(\lfloor\frac{x}{d}\rfloor)$ 呢？

除了题目直接告诉你的性质之外，一般的函数需要借用之前提到的卷积。我们先找到一个函数 $g(x)$ ，满足 $g(x)$ 和 $(f*g)(x)$ 都可以快速算出。比如对于 $\mu$ 函数和 $\varphi$ 函数来说， $I$ 函数就是一个合理的选择。因为 $I(x)$ 就是 1 ，而 $(\mu*I)(x)=[x=1],(\varphi*I)(x)=x$ 。

具体怎么实现呢？我们来看：

$$
\sum_{i=1}^{n}{}
$$