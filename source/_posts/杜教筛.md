---
title: 杜教筛
comments: true
top: 2
date: 2022-10-21 08:37:22
updateDate: 2022-10-21 08:37:22
tags:
categories:
---

<!--more-->

## 狄利克雷卷积

定义两个函数的狄利克雷卷积如下：

$$
\begin{aligned}
f(x) * g(x) &= (f * g)(x)\\
&= \sum_{ab=x}{f(a)g(b)}\\
&= \sum_{d \mid x}{f(d)g(\frac{x}{d})}
\end{aligned}
$$

其中第一个表达式作为定义式，可以在进行和号变换的时候对理解产生很大帮助。第二个式子则更为常见，可以应用在各种反演之中：

比如常见的莫比乌斯反演和欧拉反演（证明见[反演](/2022/10/24/反演)）（$I(x)=1$）：

$$
\begin{aligned}
(\mu * I)(x) &= \sum_{d \mid x}{\mu(x)I(x)}\\
&= \sum_{d \mid x}{\mu(x)}\\
&= [x==1]\\
&= \varepsilon(x)
\\(\varphi * I)(x) &= \sum_{d \mid x}{\varphi(x)I(x)}\\
&=\sum_{d \mid x}{\varphi(x)}\\
&=x
\end{aligned}
$$

好，这些知识就足够了。

## 杜教筛

杜教筛其实就是能筛这样的一个函数：

$$
f(x)=g(x)-\sum_{d=2}^{x}f(\lfloor\frac{x}{d}\rfloor)
$$

如果 $g(x)$ 可以很快地算出来的话，那么第二项可以利用[数论分块]()递归 $\sqrt x$ 次。然后